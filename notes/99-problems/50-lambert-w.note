!type:Basic
!deck:Math::Calculus::Problems::Lambert W
!tags:Math Calculus Problem Lambert-W
!template:Basic

!front:
\[ \frac{d}{dx} W(x) \]
Find the derivative of the Lambert \(W\) function.
!back:
Use implicit differentiation:

\[
\begin{align*}
    W(x) e^{W(x)} &= x \\
    \frac{d}{dx} \left( W(x) e^{W(x)} \right) &= \frac{d}{dx} x
\end{align*}
\]

Use the chain rule:

\[
\begin{align*}
    W(x) e^{W(x)} \cdot W'(x) + e^{W(x)} \cdot W'(x) &= 1 \\
    W'(x) ( W(x) e^{W(x)} + e^{W(x)} ) &= 1 \\
    W'(x) ( x + e^{W(x)} ) &= 1
\end{align*}
\]

Since

\[ W(x)e^{W(x)} = x \implies e^{W(x)} = x/W(x) \]

Then:

\[
\begin{align*}
    W'(x) &= \frac{1}{x + e^{W(x)}}  \\
    &= \frac{1}{x + x/W(x)} \\
    &= \frac{W(x)}{x W(x) + x} \\
    &= \frac{W(x)}{x (W(x) + 1)}
\end{align*}
\]
~~~

!front:
\[ \int W(x) \, dx \]
Find the anti-derivative of the Lambert \(W\) function.
!back:
Apply \(u\)-substitution:

\[
\begin{align*}
     u &= W(x) \\
     x &= u e^u \\
    dx &= (u e^u + e^u) \, du \\
       &= e^u (u  + 1) \, du
\end{align*}
\]

Then:

\[
\begin{align*}
    &= \int W(x) \, dx \\
    &= \int u e^u(u+1) \, du \\
    &= \int e^u (u^2 + u) \, du, \quad \text{Integrate by parts} \\
    &= (u^2 + u) e^u - (2u + 1) e^u + 2e^u + C \\
    &= u u e^u - u e^u + e^u + C \\
    &= x W(x) - W(x) + e^{W(x)} + C \\
    &= x W(x) - W(x) + \frac{x}{W(x)} + C
\end{align*}
\]
~~~

!front: \[ W(W(x)) = 1 \]
!back:
\[
\begin{align*}
    W(W(x)) &= 1 \\
       W(x) &= 1 e^1 \\
            &= e \\
          x &= e e^e \\
            &= e^{e+1}
\end{align*}
\]
~~~

!front: \[ W(x) = \ln(2x) \]
!back:
\[
\begin{align*}
    W(x) &= \ln(2x) \\
       x &= \ln(2x) e^{\ln(2x)} \\
         &= 2x \ln(2x) \\
\end{align*}
\]

\[
\begin{align*}
     2x \ln(2x) &= x \\
        \ln(2x) &= \frac{1}{2} \\
    e^{\ln(2x)} &= e^{\frac{1}{2}} \\
             2x &= e^{\frac{1}{2}} \\
              x &= \frac{1}{2} e^{\frac{1}{2}}
\end{align*}
\]
~~~

!front: \[ W(e^x) = (W(e))^x \]
!back:
\[
\begin{align*}
    W(e^x) &= (W(e))^x \\
    W(e^x) &= (W(1 e^1))^x \\
    W(e^x) &= (1)^x \\
    W(e^x) &= 1 \\
       e^x &= 1 e^1 \\
         x &= 1
\end{align*}
\]
~~~
